// PRODUCTOS
const productos2 = [
  {
    id: "abrigo-01",
    titulo: "Abrigo 01",
    imagen: "../img/abrigos/01.jpg",
    categoria: {
      nombre: "Abrigos",
      id: "abrigos",
    },
    precio: 1000,
  },
  {
    id: "abrigo-02",
    titulo: "Abrigo 02",
    imagen: "../img/abrigos/02.jpg",
    categoria: {
      nombre: "Abrigos",
      id: "abrigos",
    },
    precio: 1000,
  },
  {
    id: "abrigo-03",
    titulo: "Abrigo 03",
    imagen: "../img/abrigos/03.jpg",
    categoria: {
      nombre: "Abrigos",
      id: "abrigos",
    },
    precio: 1000,
  },
  {
    id: "abrigo-04",
    titulo: "Abrigo 04",
    imagen: "../img/abrigos/04.jpg",
    categoria: {
      nombre: "Abrigos",
      id: "abrigos",
    },
    precio: 1000,
  },
  {
    id: "abrigo-05",
    titulo: "Abrigo 05",
    imagen: "../img/abrigos/05.jpg",
    categoria: {
      nombre: "Abrigos",
      id: "abrigos",
    },
    precio: 1000,
  },
  {
    id: "camiseta-01",
    titulo: "Camiseta 01",
    imagen: "../img/camisetas/01.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-02",
    titulo: "Camiseta 02",
    imagen: "../img/camisetas/02.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-03",
    titulo: "Camiseta 03",
    imagen: "../img/camisetas/03.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-04",
    titulo: "Camiseta 04",
    imagen: "../img/camisetas/04.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-05",
    titulo: "Camiseta 05",
    imagen: "../img/camisetas/05.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-06",
    titulo: "Camiseta 06",
    imagen: "../img/camisetas/06.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-07",
    titulo: "Camiseta 07",
    imagen: "../img/camisetas/07.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "camiseta-08",
    titulo: "Camiseta 08",
    imagen: "../img/camisetas/08.jpg",
    categoria: {
      nombre: "Camisetas",
      id: "camisetas",
    },
    precio: 1000,
  },
  {
    id: "pantalon-01",
    titulo: "Pantalón 01",
    imagen: "../img/pantalones/01.jpg",
    categoria: {
      nombre: "Pantalones",
      id: "pantalones",
    },
    precio: 1000,
  },
  {
    id: "pantalon-02",
    titulo: "Pantalón 02",
    imagen: "../img/pantalones/02.jpg",
    categoria: {
      nombre: "Pantalones",
      id: "pantalones",
    },
    precio: 1000,
  },
  {
    id: "pantalon-03",
    titulo: "Pantalón 03",
    imagen: "../img/pantalones/03.jpg",
    categoria: {
      nombre: "Pantalones",
      id: "pantalones",
    },
    precio: 1000,
  },
  {
    id: "pantalon-04",
    titulo: "Pantalón 04",
    imagen: "../img/pantalones/04.jpg",
    categoria: {
      nombre: "Pantalones",
      id: "pantalones",
    },
    precio: 1000,
  },
  {
    id: "pantalon-05",
    titulo: "Pantalón 05",
    imagen: "../img/pantalones/05.jpg",
    categoria: {
      nombre: "Pantalones",
      id: "pantalones",
    },
    precio: 1000,
  },
];

const productos = [
  {
    "id": 2,
    "imagen": "../img/moldes/molde-egg-deco-cakelet-nordic-ware.jpg",
    "nombre": "Molde Egg Deco Cakelet Nordic Ware",
    "categoria": {
      "id": 1,
      "nombre": "moldes"
    },
    "precio": 80000
  },
  {
    "id": 3,
    "imagen": "../img/moldes/molde-braided-bundt-nordic-ware.jpg",
    "nombre": "Molde Braided Bundt Nordic Ware ",
    "categoria": {
      "id": 1,
      "nombre": "moldes"
    },
    "precio": 80000
  },
  {
    "id": 4,
    "imagen": "../img/moldes/molde-anniversary-chico-nordic-ware.jpg",
    "nombre": "Molde Anniversary Chico Nordic Ware",
    "categoria": {
      "id": 1,
      "nombre": "moldes"
    },
    "precio": 80000
  },
  {
    "id": 5,
    "imagen": "../img/moldes/molde-braided-bundt-nordic-ware.jpg",
    "nombre": "Molde Braided Bundt Nordic Ware",
    "categoria": {
      "id": 1,
      "nombre": "moldes"
    },
    "precio": 80000
  },

  {
    "id": 12,
    "imagen": "../img/chocolates/chocolate-cobertura-blanco-90-fenix.jpg",
    "nombre": "Chocolate Cobertura Blanco 90 Fenix",
    "categoria": {
      "id": 2,
      "nombre": "chocolates"
    },
    "precio": 40000
  },

  {
    "id": 13,
    "imagen": "../img/chocolates/chocolate-cobertura-amargo-87-fenix.jpg",
    "nombre": "Chocolate Cobertura Amargo  Fenix",
    "categoria": {
      "id": 2,
      "nombre": "chocolates"
    },
    "precio": 20000
  },
  {
    "id": 18,
    "imagen": "../img/chocolates/chocolate-cobertura-con-leche-extraliquido-71-fenix.jpg",
    "nombre": "Chocolate Cobertura Extraliquido 71 Fenix",
    "categoria": {
      "id": 2,
      "nombre": "chocolates"
    },
    "precio": 30000
  },
  {
    "id": 19,
    "imagen": "../img/herramientas/cuchara-redondeada.jpg",
    "nombre": "Cuchara Redondeada",
    "categoria": {
      "id": 3,
      "nombre": "herramientas"
    },
    "precio": 10000
  },

  {
    "id": 14,
    "imagen": "../img/chocolates/chocolate-cobertura-dark-belcolade.jpg",
    "nombre": "Chocolate Cobertura Dark Belcolade",
    "categoria": {
      "id": 2,
      "nombre": "chocolates"
    },
    "precio": 20000
  },
  {
    "id": 16,
    "imagen": "../img/chocolates/chocolate-cobertura-semi-amargo-sin-azucar.jpg",
    "nombre": "Chocolate Cobertura Semi Amargo Sin Azúcar",
    "categoria": {
      "id": 2,
      "nombre": "chocolates"
    },
    "precio": 20000
  },
  {
    "id": 9,
    "imagen": "../img/moldes/molde-charlotte-cake-nordic-ware.jpg",
    "nombre": "Molde Charlotte Cake Nordic Ware",
    "categoria": {
      "id": 1,
      "nombre": "moldes"
    },
    "precio": 70000
  },
  {
    "id": 22,
    "imagen": "../img/herramientas/espatula-cake-server-nordic-ware.jpg",
    "nombre": "Espátula Cake Server Nordic Ware",
    "categoria": {
      "id": 3,
      "nombre": "herramientas"
    },
    "precio": 20000
  },
  {
    "id": 23,
    "imagen": "../img/herramientas/espatula-branca-grande.jpg",
    "nombre": "Espátula Branca Grande",
    "categoria": {
      "id": 3,
      "nombre": "herramientas"
    },
    "precio": 14000
  },
  {
    "id": 28,
    "imagen": "../img/herramientas/cuchara-de-silicona-dl.jpg",
    "nombre": "Cuchara De Silicona DL",
    "categoria": {
      "id": 3,
      "nombre": "herramientas"
    },
    "precio": 23000
  }
];
// Función para cargar el archivo JSON
async function leerProductos() {
  try {
    const response = await fetch("js/productos.json"); // Reemplaza 'productos.json' con la ruta correcta si es necesario
    if (!response.ok) {
      throw new Error("Error al cargar el archivo JSON");
    }
    const data = await response.json(); // Convierte la respuesta a JSON
    productos = data.productos; // Accede al array de productos
    // Aquí puedes trabajar con el array de productos
  } catch (error) {
    console.error("Error:", error);
  }
}

const contenedorProductos = document.querySelector("#contenedor-productos");
const botonesCategoria = document.querySelectorAll(".boton-categoria");
const tituloPagina = document.querySelector("#titulo-principal");
let botonesAgregar = document.querySelectorAll(".producto-agregar");
const numeritoTexto = document.querySelector("#numerito");

// Funcion para cargar productos a la pagina
function cargarProductos(productos) {
  contenedorProductos.innerHTML = "";

  for (let i = 0; i < productos.length; i++) {
    const div = document.createElement("div");
    div.classList.add("producto");
    div.innerHTML = `  
        <img class="producto-imagen" src="${productos[i].imagen}" alt="${productos[i].imagen}" />
        <div class="producto-descripcion">
          <h3 class="producto-titulo">${productos[i].nombre}</h3>
          <p class="producto-precio">${productos[i].precio}</p>
          <button class="producto-agregar" id="${productos[i].id}">Agregar</button>
        </div>
    `;
    contenedorProductos.append(div);
  }
  actualizaBotonesAgregar();
}

cargarProductos(productos);

// Add event listener a cada botón de categoría
for (let i = 0; i < botonesCategoria.length; i++) {
  botonesCategoria[i].addEventListener("click", (e) => {
    botonesCategoria.forEach((boton) => boton.classList.remove("active"));
    e.currentTarget.classList.add("active");
    if (e.currentTarget.id === "todos") {
      cargarProductos(productos);
      tituloPagina.innerText = "Todos los productos";
    } else {
      const productosCategoria = productos.filter((producto) => producto.categoria.id === e.currentTarget.id);
      cargarProductos(productosCategoria);
      tituloPagina.innerText = e.currentTarget.innerText;
    }
  });
}

// Agrego un listener a cada boton comprar
function actualizaBotonesAgregar() {
  botonesAgregar = document.querySelectorAll(".producto-agregar");
  botonesAgregar.forEach((boton) => {
    boton.addEventListener("click", agregarAlCarrito);
  });
}
let productosEnCarrito;
if (localStorage.getItem("productos-en-carrito")) {
  productosEnCarrito = JSON.parse(localStorage.getItem("productos-en-carrito"));
  actualizarNumerito();
} else {
  productosEnCarrito = [];
}
function agregarAlCarrito(e) {
  const botonId = e.currentTarget.id;
  console.log(botonId);
  const productoAgregado = productos.find((producto) => producto.id == botonId);
  console.log(productoAgregado)
  if (productosEnCarrito.some((producto) => producto.id === productoAgregado.id)) {
    const index = productosEnCarrito.findIndex((producto) => producto.id === productoAgregado.id);
    productosEnCarrito[index].cantidad++;
  } else {
    productoAgregado.cantidad = 1;
    productosEnCarrito.push(productoAgregado);
  }
  actualizarNumerito();
  localStorage.setItem("productos-en-carrito", JSON.stringify(productosEnCarrito));
}

function actualizarNumerito() {
  const numerito = productosEnCarrito.reduce((total, producto) => total + producto.cantidad, 0);
  numeritoTexto.innerText = numerito;
}
